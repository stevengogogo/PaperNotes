<!doctype html><html lang=en><meta charset=utf-8><meta name=generator content="Hugo 0.78.1"><meta name=viewport content="width=device-width,initial-scale=1,viewport-fit=cover"><meta name=color-scheme content="light dark"><meta name=supported-color-schemes content="light dark"><title>Sachetto 2018&nbsp;&ndash;&nbsp;Papers</title><link rel=stylesheet href=/stevengogogo/PaperNotes/css/core.min.0e6154f1fe5441faaa4f418ca1a607b9f3edbad43b1ab8782737ee279ca2c5a48c8dbe23af3340af50c91a2558bc2b55.css integrity=sha384-DmFU8f5UQfqqT0GMoaYHufPtutQ7Grh4JzfuJ5yixaSMjb4jrzNAr1DJGiVYvCtV><meta name=twitter:card content="summary"><meta name=twitter:title content="Sachetto 2018"><body><section id=header><div class="header wrap"><span class="header left-side"><a class="site home" href=/stevengogogo/PaperNotes/><span class="site name">Papers</span></a></span>
<span class="header right-side"><div class="nav wrap"><nav class=nav><a class="nav item" href=/stevengogogo/PaperNotes/categories/>Categories</a><a class="nav item" href=/stevengogogo/PaperNotes/tags/>Tags</a></nav></div></span></div><div class="site slogan"><span class=title>Collection of papers I read</span></div></section><section id=content><div class=article-container><section class="article header"><h1 class="article title">Sachetto 2018</h1><p class="article date">2020-10-23</p></section><article class="article markdown-body"><p><a href=https://sciwheel.com/work/#/items/4898772 target=_blank>Sciwheel</a></p><p><a href=https://onlinelibrary.wiley.com/doi/full/10.1002/cnm.2913 target=_blank>Article</a><sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup></p><h2 id=introduction>INTRODUCTION</h2><ul><li>The cardiac models used nowadays are described by nonlinear systems of partial differential equations (PDE) coupled to a nonlinear set of ordinary differential equations (ODE) resulting in mathematical formulations with millions of variables and hundreds of parameters</li><li>In this work, we address these questions by combining a modern parallel computing technique based on multicore and graphics processing units (GPUs) and a sophisticated numerical method based on a new space-time adaptive algorithm.</li></ul><h2 id=methods>METHODS</h2><ul><li>electrical wavefron: 0.2mm => adaptive mesh methods can be used.</li><li>However, the use of adaptive methods combined with parallel computing also introduces new problems to be solved</li></ul><h3 id=monodomain-model>Monodomain model</h3><p>$$
\beta C_{m} \frac{\partial V}{\partial t}+\beta I_{i o n}(V, \eta)=\nabla \cdot(\sigma \nabla V)+I_{s t i m}
$$
$$
\frac{\partial \eta}{\partial t}=f(V, \eta)
$$</p><ul><li>TT2 is based on the Hodgkin-Huxley formalism and is described by 19 ODEs, whereas the BDK is based on 41 ODEs and is based on Markov-MCs.</li></ul><h3 id=finite-volume-method-fvm-applied-to-monodomain>Finite volume method (FVM) applied to monodomain</h3><ul><li>Godunov operator splitting:
ODE part
$$
\begin{array}{c}{\frac{\partial V}{\partial t}=\frac{1}{C_{m}}\left[-I_{i o n}\left(V, \eta_{i}\right)+I_{s t i m}\right]} \ {\frac{\partial \eta_{i}}{\partial t}=f\left(V, \eta_{i}\right)}\end{array}
$$
PDE part
$$
\beta C_{m} \frac{\partial V}{\partial t}=[\nabla \cdot(\sigma \nabla V)]
$$</li></ul><h3 id=time-discretization>Time discretization</h3><ul><li>implicit first-order Euler scheme
$$
\frac{\partial V}{\partial t}=\frac{V^{n+1}-V^{n}}{\Delta t}
$$</li></ul><h3 id=space-discretization>Space discretization</h3><ul><li>The calculation of J (fluxes) can be split as the sum of the flows on the 6 faces
$$
h^{3} \beta C_{m} \frac{\partial V}{\partial t}=h^{2} \sum_{l=1}^{6} J_{l}
$$</li></ul><h3 id=adaptive-nonuniform-mesh>Adaptive nonuniform mesh</h3><ul><li>we can use algorithms and data structures that can transform a single volume of the mesh in 8 smaller volumes by refining it, or apply the inverse operation by derefining 8 smaller volumes into a single one.</li><li>efficient graph-based data structure called <strong>autonomous leaves graph (ALG)</strong>
<img src=https://user-images.githubusercontent.com/40054455/86707380-78802b80-c04a-11ea-8497-bcce76d818a4.png alt=fig1></li><li>We will approximate the partial derivatives of V on the interfaces using the finite difference scheme due to the mesh of cubes
$$
\begin{aligned}\left.\frac{\partial V}{\partial x}\right|<em>{(i+1 / 2, j, k)} &=\sum</em>{c=1}^{m_{1}} \frac{V_{r, c}^{*}-V_{i, j, k}^{*}}{h_{1}} \\left.\frac{\partial V}{\partial x}\right|_{(i-1 / 2, j, k)} &=\sum_{c=1}^{m_{2}} \frac{V_{i, j, k}^{*}-V_{l, c}^{*}}{h_{2}} \end{aligned}
$$</li><li>decomposing the operators
$$
\begin{array}{c}{C_{m} \frac{V_{i j, k}^{*}-V_{i, j, k}^{n}}{\Delta t}=-\frac{\left(S_{1} J_{1}^{*}-S_{2} J_{2}^{*}+S_{3} J_{3}^{*}-S_{4} J_{4}^{*}+S_{5} J_{5}^{*}-S_{6} J_{6}^{*}\right)}{\beta h_{i j, k}^{3}}} \ {C_{m} \frac{V_{i j, k}^{n+1}-V_{i, j, k}^{*}}{\Delta t}=-I_{i o n}\left(V_{i, j, k}^{*}, \eta^{n}\right)} \ {\frac{\partial \eta^{n+1}}{\partial t}=f\left(\eta^{n}, V^{*}, t\right)}\end{array}
$$
$$
\begin{array}{c}{S_{1} J_{1}^{*}=-\sigma_{x_{i+1 / 2 j k}} \sum_{c=1}^{m_{1}} \frac{V_{r, c}^{*}-V_{i, j, k}^{*}}{h_{1}} S_{1}} \ {S_{2} J_{2}^{*}=-\sigma_{x_{i-1 / 2 j k}} \sum_{c=1}^{m_{2}} \frac{V_{i j, k}^{*}-V_{l, c}^{*}}{h_{2}} S_{2}}\end{array}
$$</li><li>For a regular grid, we can simplify the above equations
$$
J_{1}=J_{x_{i+1 / 2 j k}}=-\sum_{c=1}^{m_{1}} \sigma_{x_{r^{\prime}, c}}\left(V_{r, c}^{*}-V_{i j, k}^{*}\right) h_{1}
$$
$$
J_{2}=J_{x_{i-1 / 2 j, k}}=-\sum_{c=1}^{m_{2}} \sigma_{x_{l, c}}\left(V_{i, j, k}^{*}-V_{l, c}^{*}\right) h_{2}
$$</li></ul><h3 id=adaptive-time-step-method-for-solving-odes>Adaptive time-step method for solving ODEs</h3><ul><li>To overcome this problem, we used an adaptive time-step Euler method</li></ul><h3 id=parallel-numerical-implementations>Parallel numerical implementations</h3><ul><li>model a total of 500 × 500 × 500 × 41 = 5125000000 unknowns</li><li>Since the TT2 model contains a large number of variables that follows the Hodgkin-Huxley gating formalism,9we used the Rush-Larsen (RL) method. Unfortunately, this method is not suitable for the BDK, owing to the MCs used in the model formulation.</li></ul><h3 id=computational-simulations>Computational simulations</h3><p><span class=image-container><span class=link><img class=img src=https://user-images.githubusercontent.com/40054455/86707397-7d44df80-c04a-11ea-9e1b-dec24e608257.png alt=fig2></span><span class=caption><span class=title>S1 and S2 stimuli applied on the 3D model of the murine left ventricule</span></span></span>
<span class=image-container><span class=link><img class=img src=https://user-images.githubusercontent.com/40054455/86707410-80d86680-c04a-11ea-805e-c9b608b8abdf.png alt=fig3></span><span class=caption><span class=title>Propagation of the electrical wave in the benchmark problem mesh</span></span></span>
<span class=image-container><span class=link><img class=img src=https://user-images.githubusercontent.com/40054455/86707416-83d35700-c04a-11ea-9c29-56d138bcc6cb.png alt=fig4></span><span class=caption><span class=title>Spiral wave in the left ventricular mouse mesh</span></span></span></p><h2 id=results>RESULTS</h2><ul><li>SA method changes the matrix conditioning and the use of Jacobi preconditioner was adequate to reduce the total number of CG iterations from 2339 to 993.
<span class=image-container><span class=link><img class=img src=https://user-images.githubusercontent.com/40054455/86707446-8b92fb80-c04a-11ea-8c75-0dc2487215a7.png alt=fig6></span><span class=caption><span class=title>Comparison of the APs in a fixed point for Test 3</span></span></span></li></ul><h2 id=discussion>DISCUSSION</h2><h3 id=modern-parallel-computing-vs-sophisticated-numerical-methods>Modern parallel computing vs sophisticated numerical methods</h3><p><img src=https://user-images.githubusercontent.com/40054455/94364891-42a98b00-00ff-11eb-8df1-c3d913c54ee4.png alt></p><ul><li>Only the ODEs are solved in the GPU, whereas the total time of the simulation is the sum of time spent solving the ODEs plus the time spent solving the PDE.</li></ul><h3 id=limitations-and-future-work>Limitations and future work</h3><ul><li>load unbalance in the GPU code</li></ul><p><span class=image-container><span class=link><img class=img src=https://user-images.githubusercontent.com/40054455/94364903-58b74b80-00ff-11eb-8b46-76a50f091c31.png alt></span><span class=caption><span class=title>S1 and S2 stimuli applied on the 3D model of the murine left ventricule</span></span></span></p><ul><li>the use of parallel computing and space-time adaptive methods are able to reduce the execution time of a simulation by more than 498 × (from 11 days to less than 32 minutes)</li></ul><h2 id=reference>Reference</h2><section class=footnotes role=doc-endnotes><hr><ol><li id=fn:1 role=doc-endnote><p>Sachetto Oliveira R, Martins Rocha B, Burgarelli D, Meira W, Constantinides C, Weber Dos Santos R. Performance evaluation of GPU parallelization, space-time adaptive algorithms, and their combination for simulating cardiac electrophysiology. Int. J. Numer. Method. Biomed. Eng. 2018;34(2). doi:10.1002/cnm.2913 <a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></section></article><section class="article author"><p class=name>Shao-Ting Chiu</p><div class=details><a class=item href=https://github.com/stevengogogo target=_blank><span class="iconfont icon-github"></span>&nbsp;stevengogogo</a></div></section></div><div class="article bottom"><section class="article navigation"><p><a class=link href=/stevengogogo/PaperNotes/posts/sarkar-2010/><span class="iconfont icon-article"></span>Sarkar 2010</a></p><p><a class=link href=/stevengogogo/PaperNotes/posts/saa-2015/><span class="iconfont icon-article"></span>Saa 2015</a></p></section></div></section><section id=footer><div class=footer-wrap><p class=copyright>Papers</p><p class=powerby><span>Powered&nbsp;by&nbsp;</span><a href=https://gohugo.io target=_blank>Hugo</a><span>&nbsp;&&nbsp;</span><a href=https://themes.gohugo.io/hugo-notepadium/ target=_blank>Notepadium</a></p></div></section><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css integrity=sha384-zB1R0rpPzHqg7Kpt0Aljp8JPLqbXI3bhnPWROx27a9N0Ll6ZP/+DiW/UqRcLbRjq crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.js integrity=sha384-y23I5Q6l+B6vatafAwxRu/0oK/79VlbSz7Q9aiSZUvyWYIYsd+qj+o24G5ZU2zJz crossorigin=anonymous></script><script defer src=https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/auto-render.min.js integrity=sha384-kWPLUVMOks5AQFrykwIup5lo0m3iMkkHrD0uJ4H5cjeGihAutqP0yW0J6dpFiVkI crossorigin=anonymous onload=renderMathInElement(document.body);></script></body></html>